USE nyc_taxi_discovery;

SELECT code_id, rate_code
FROM
    OPENROWSET(
        BULK 'raw/rate_code.json',
        DATA_SOURCE = 'nyc_taxi_data',
        FORMAT = 'CSV',
        PARSER_VERSION = '1.0',
        FIELDQUOTE = '0x0b',
        FIELDTERMINATOR = '0x0b', 
        ROWTERMINATOR = '0x0b'  -- vertical tab
    )
    WITH (
        jsonDoc NVARCHAR(MAX)
    )
    AS rate_code
    CROSS APPLY OPENJSON(jsonDoc)
    WITH (
        code_id INT '$.rate_code_id',
        rate_code VARCHAR(25)
    );
