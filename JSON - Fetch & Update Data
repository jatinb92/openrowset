USE nyc_taxi_discovery;

SELECT 
    CAST(JSON_VALUE(jsonDoc, '$.payment_type') AS SMALLINT) pay_type,
    CAST(JSON_VALUE(jsonDoc, '$.payment_type_desc') AS VARCHAR(15)) pay_type_description
FROM
    OPENROWSET(
        BULK 'raw/payment_type.json',
        DATA_SOURCE = 'nyc_taxi_data',
        FORMAT = 'CSV',
        PARSER_VERSION = '1.0',
        FIELDQUOTE = '0x0b',
        FIELDTERMINATOR = '0x0b', 
        ROWTERMINATOR = '0x0a' -- new line
    )
    WITH (
        jsonDoc NVARCHAR(MAX)
    )
    AS payment_type;
